<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Studio - Professional Development Environment</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 1rem 2rem;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header h1 {
      color: #2c3e50;
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1rem;
    }

    .main-container {
      display: flex;
      height: calc(100vh - 120px);
      padding: 1rem;
      gap: 1rem;
    }

    /* Game Emulator Section */
    .game-emulator {
      width: 300px;
      background: #20B2AA;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .game-screen {
      width: 200px;
      height: 150px;
      background: #000;
      border-radius: 10px;
      margin-bottom: 15px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 12px;
    }

    .sound-toggle {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 20px;
      height: 20px;
      background: #ff4444;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 10px;
    }

    .game-controls {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .d-pad {
      width: 80px;
      height: 80px;
      background: #ccc;
      border-radius: 10px;
      position: relative;
    }

    .d-pad::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      background: #999;
      border-radius: 50%;
    }

    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .action-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }

    .btn-a {
      background: #ff6b6b;
      color: white;
    }

    .btn-b {
      background: #4ecdc4;
      color: white;
    }

    .menu-btn {
      background: #95a5a6;
      color: white;
      padding: 5px 15px;
      border: none;
      border-radius: 5px;
      margin: 10px 0;
    }

    .microsoft-logo {
      font-size: 10px;
      color: white;
      margin-top: 10px;
    }

    .emulator-toolbar {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .toolbar-btn {
      width: 25px;
      height: 25px;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      border-radius: 3px;
      color: white;
      cursor: pointer;
    }

    /* Block Categories Section */
    .block-categories {
      width: 250px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .search-bar {
      padding: 1rem;
      border-bottom: 1px solid #e9ecef;
    }

    .search-input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 0.9rem;
    }

    .categories-list {
      flex: 1;
      overflow-y: auto;
      padding: 0.5rem;
    }

    .category-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.2s;
      margin-bottom: 0.25rem;
    }

    .category-item:hover {
      background: #f8f9fa;
    }

    .category-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      font-size: 12px;
    }

    .category-text {
      font-size: 0.9rem;
      font-weight: 500;
    }

    /* Color coding for categories */
    .sprite { background: #3498db; color: white; }
    .controller { background: #e67e22; color: white; }
    .game { background: #9b59b6; color: white; }
    .music { background: #e91e63; color: white; }
    .scene { background: #27ae60; color: white; }
    .info { background: #e74c3c; color: white; }
    .loops { background: #2ecc71; color: white; }
    .logic { background: #3498db; color: white; }
    .variables { background: #e74c3c; color: white; }
    .math { background: #9b59b6; color: white; }
    .animation { background: #2ecc71; color: white; }
    .extensions { background: #95a5a6; color: white; }

    /* Coding Workspace */
    .coding-workspace {
      flex: 1;
      background: #f8f9fa;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .workspace-background {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: radial-gradient(circle, #ddd 1px, transparent 1px);
      background-size: 20px 20px;
      opacity: 0.3;
    }

    .workspace-content {
      position: relative;
      z-index: 1;
      padding: 2rem;
      min-height: 100%;
    }

    .start-block {
      background: #27ae60;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      display: inline-block;
      font-weight: 600;
      margin-bottom: 1rem;
      box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
    }

    .block {
      display: inline-block;
      padding: 0.75rem 1rem;
      margin: 0.25rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s;
      user-select: none;
      position: relative;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .block:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
    }

    .block::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      border-right: 8px solid currentColor;
    }

    .block::after {
      content: '';
      position: absolute;
      right: -8px;
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      border-left: 8px solid currentColor;
    }

    /* Block colors */
    .block.sprite { background: #3498db; color: white; }
    .block.controller { background: #e67e22; color: white; }
    .block.game { background: #9b59b6; color: white; }
    .block.music { background: #e91e63; color: white; }
    .block.scene { background: #27ae60; color: white; }
    .block.info { background: #e74c3c; color: white; }
    .block.loops { background: #2ecc71; color: white; }
    .block.logic { background: #3498db; color: white; }
    .block.variables { background: #e74c3c; color: white; }
    .block.math { background: #9b59b6; color: white; }
    .block.animation { background: #2ecc71; color: white; }

    /* Mode Switcher */
    .mode-switcher {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 1rem;
      margin-bottom: 1rem;
      display: flex;
      gap: 1rem;
      justify-content: center;
    }

    .mode-btn {
      padding: 0.75rem 1.5rem;
      border: 2px solid #3498db;
      background: transparent;
      color: #3498db;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }

    .mode-btn.active {
      background: #3498db;
      color: white;
    }

    .mode-btn:hover {
      background: #3498db;
      color: white;
      transform: translateY(-2px);
    }

    /* Text Editor */
    .text-editor {
      display: none;
    }

    .text-editor.active {
      display: block;
    }

    .editor-section {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .editor-header {
      background: #2c3e50;
      color: white;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .editor-title {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .editor-controls {
      display: flex;
      gap: 0.5rem;
    }

    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-success {
      background: #27ae60;
      color: white;
    }

    .btn-success:hover {
      background: #229954;
      transform: translateY(-1px);
    }

    .code-editor {
      width: 100%;
      height: 400px;
      font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      line-height: 1.5;
      padding: 1rem;
      border: none;
      resize: vertical;
      background: #1e1e1e;
      color: #d4d4d4;
      outline: none;
    }

    .output-section {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .output-header {
      background: #27ae60;
      color: white;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .output-content {
      padding: 1rem;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      line-height: 1.4;
      background: #f8f9fa;
      min-height: 200px;
      max-height: 400px;
      overflow-y: auto;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .main-container {
        flex-direction: column;
        height: auto;
      }
      
      .game-emulator {
        width: 100%;
        max-width: 400px;
        margin: 0 auto;
      }
      
      .block-categories {
        width: 100%;
        max-height: 200px;
      }
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.5rem;
      }
      
      .main-container {
        padding: 0.5rem;
      }
      
      .workspace-content {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üöÄ Code Studio - Professional Development Environment</h1>
    <p>Create games and applications with visual block coding or text programming!</p>
  </div>

  <div class="mode-switcher">
    <button class="mode-btn active" onclick="switchMode('blocks')">üß± Block Coding</button>
    <button class="mode-btn" onclick="switchMode('text')">üìù Text Editor</button>
  </div>

  <div class="main-container">
    <!-- Game Emulator -->
    <div class="game-emulator">
      <div class="game-screen">
        <div class="sound-toggle">üîá</div>
        <div id="game-display">Game Preview</div>
      </div>
      
      <div class="game-controls">
        <div class="d-pad"></div>
        <div class="action-buttons">
          <button class="action-btn btn-a">A</button>
          <button class="action-btn btn-b">B</button>
        </div>
      </div>
      
      <button class="menu-btn">Menu</button>
      <button class="menu-btn">üîÑ</button>
      
      <div class="microsoft-logo">Microsoft</div>
      
      <div class="emulator-toolbar">
        <button class="toolbar-btn">üîÑ</button>
        <button class="toolbar-btn">üêõ</button>
        <button class="toolbar-btn">üîä</button>
        <button class="toolbar-btn">‚å®Ô∏è</button>
        <button class="toolbar-btn">üì∑</button>
        <button class="toolbar-btn">‚õ∂</button>
      </div>
    </div>

    <!-- Block Categories -->
    <div class="block-categories">
      <div class="search-bar">
        <input type="text" class="search-input" placeholder="Search blocks..." onkeyup="filterCategories(this.value)">
      </div>
      
      <div class="categories-list">
        <div class="category-item" onclick="showBlocks('sprite')">
          <div class="category-icon sprite">‚úàÔ∏è</div>
          <div class="category-text">Sprites</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('controller')">
          <div class="category-icon controller">üéÆ</div>
          <div class="category-text">Controller</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('game')">
          <div class="category-icon game">‚ö™</div>
          <div class="category-text">Game</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('music')">
          <div class="category-icon music">üéß</div>
          <div class="category-text">Music</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('scene')">
          <div class="category-icon scene">üå≥</div>
          <div class="category-text">Scene</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('info')">
          <div class="category-icon info">üë§</div>
          <div class="category-text">Info</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('loops')">
          <div class="category-icon loops">üîÑ</div>
          <div class="category-text">Loops</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('logic')">
          <div class="category-icon logic">üîó</div>
          <div class="category-text">Logic</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('variables')">
          <div class="category-icon variables">‚ò∞</div>
          <div class="category-text">Variables</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('math')">
          <div class="category-icon math">üßÆ</div>
          <div class="category-text">Math</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('animation')">
          <div class="category-icon animation">üé¨</div>
          <div class="category-text">Animation</div>
        </div>
        
        <div class="category-item" onclick="showBlocks('extensions')">
          <div class="category-icon extensions">‚ûï</div>
          <div class="category-text">Extensions</div>
        </div>
        
        <div class="category-item">
          <div class="category-icon" style="background: #95a5a6; color: white;">‚ñº</div>
          <div class="category-text">Advanced</div>
        </div>
      </div>
    </div>

    <!-- Coding Workspace -->
    <div class="coding-workspace">
      <div class="workspace-background"></div>
      <div class="workspace-content">
        <div class="start-block">on start</div>
        <div id="block-workspace"></div>
      </div>
    </div>
  </div>

  <!-- Text Editor (Hidden by default) -->
  <div class="text-editor">
    <div class="editor-section">
      <div class="editor-header">
        <div class="editor-title">üìù Code Editor</div>
        <div class="editor-controls">
          <button class="btn btn-warning" id="save-btn">üíæ Save</button>
          <button class="btn btn-success" id="publish-btn">üì§ Publish</button>
          <button class="btn btn-primary" id="run-btn">‚ñ∂Ô∏è Run</button>
        </div>
      </div>
      <textarea id="code-input" class="code-editor">// Welcome to the JavaScript Code Editor!
// Write your code here and click "Run" to see the output

console.log('Hello, World!');

// Try some examples:
// - Create variables
let name = 'Coder';
let age = 25;

// - Use template literals
console.log(`Hello, ${name}! You are ${age} years old.`);

// - Create a function
function greet(person) {
  return `Hello, ${person}!`;
}

console.log(greet('Friend'));

// - Use arrays
const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(n => n * 2);
console.log('Original:', numbers);
console.log('Doubled:', doubled);</textarea>
    </div>

    <div class="output-section">
      <div class="output-header">
        <div class="editor-title">üìä Output</div>
        <div class="editor-controls">
          <button class="btn btn-danger" id="clear-btn">üóëÔ∏è Clear</button>
        </div>
      </div>
      <div id="output" class="output-content">// Output will appear here when you run your code</div>
    </div>
  </div>

  <script src="js/token-manager.js"></script>
  <script src="js/project-manager.js"></script>
  <script>
    // Block definitions
    const blockCategories = {
      sprite: [
        { text: 'move by x: 0 y: 0', code: 'sprite.moveBy(0, 0);', color: 'sprite' },
        { text: 'turn by degrees: 0', code: 'sprite.turnBy(0);', color: 'sprite' },
        { text: 'go to x: 0 y: 0', code: 'sprite.goTo(0, 0);', color: 'sprite' },
        { text: 'change x by 0', code: 'sprite.changeXBy(0);', color: 'sprite' },
        { text: 'change y by 0', code: 'sprite.changeYBy(0);', color: 'sprite' },
        { text: 'set x to 0', code: 'sprite.setX(0);', color: 'sprite' },
        { text: 'set y to 0', code: 'sprite.setY(0);', color: 'sprite' },
        { text: 'point in direction 0', code: 'sprite.pointInDirection(0);', color: 'sprite' },
        { text: 'point towards mouse pointer', code: 'sprite.pointTowardsMouse();', color: 'sprite' },
        { text: 'glide 0 secs to x: 0 y: 0', code: 'sprite.glideTo(0, 0, 0);', color: 'sprite' }
      ],
      
      controller: [
        { text: 'when A button pressed', code: 'input.onButtonPressed(Button.A, () => {\n  \n});', color: 'controller' },
        { text: 'when B button pressed', code: 'input.onButtonPressed(Button.B, () => {\n  \n});', color: 'controller' },
        { text: 'when up pressed', code: 'input.onButtonPressed(Button.Up, () => {\n  \n});', color: 'controller' },
        { text: 'when down pressed', code: 'input.onButtonPressed(Button.Down, () => {\n  \n});', color: 'controller' },
        { text: 'when left pressed', code: 'input.onButtonPressed(Button.Left, () => {\n  \n});', color: 'controller' },
        { text: 'when right pressed', code: 'input.onButtonPressed(Button.Right, () => {\n  \n});', color: 'controller' },
        { text: 'is A pressed', code: 'input.buttonIsPressed(Button.A)', color: 'controller' },
        { text: 'is B pressed', code: 'input.buttonIsPressed(Button.B)', color: 'controller' }
      ],
      
      game: [
        { text: 'start countdown 0', code: 'game.startCountdown(0);', color: 'game' },
        { text: 'add score 0', code: 'info.changeScoreBy(0);', color: 'game' },
        { text: 'set score to 0', code: 'info.setScore(0);', color: 'game' },
        { text: 'add life 0', code: 'info.changeLifeBy(0);', color: 'game' },
        { text: 'set life to 0', code: 'info.setLife(0);', color: 'game' },
        { text: 'game over', code: 'game.over();', color: 'game' },
        { text: 'pause', code: 'game.pause();', color: 'game' },
        { text: 'resume', code: 'game.resume();', color: 'game' }
      ],
      
      music: [
        { text: 'play tone at 0 for 0', code: 'music.playTone(0, 0);', color: 'music' },
        { text: 'play melody', code: 'music.playMelody("", 120);', color: 'music' },
        { text: 'play melody until done', code: 'music.playMelodyUntilDone("", 120);', color: 'music' },
        { text: 'stop all sounds', code: 'music.stopAllSounds();', color: 'music' },
        { text: 'set volume 0', code: 'music.setVolume(0);', color: 'music' },
        { text: 'change volume by 0', code: 'music.changeVolumeBy(0);', color: 'music' }
      ],
      
      scene: [
        { text: 'set background image to', code: 'scene.setBackgroundImage();', color: 'scene' },
        { text: 'set background color to', code: 'scene.setBackgroundColor(0);', color: 'scene' },
        { text: 'set tile to', code: 'scene.setTile();', color: 'scene' },
        { text: 'set tile at x:0 y:0 to', code: 'scene.setTileAt(0, 0);', color: 'scene' },
        { text: 'replace all tiles with', code: 'scene.replaceAllTiles();', color: 'scene' }
      ],
      
      info: [
        { text: 'show number 0', code: 'basic.showNumber(0);', color: 'info' },
        { text: 'show string "hello"', code: 'basic.showString("hello");', color: 'info' },
        { text: 'show icon', code: 'basic.showIcon(IconNames.Heart);', color: 'info' },
        { text: 'show arrow', code: 'basic.showArrow(ArrowNames.North);', color: 'info' },
        { text: 'show leds', code: 'basic.showLeds(`\n.#.#.\n#.#.#\n.#.#.\n#.#.#\n.#.#.\n`);', color: 'info' },
        { text: 'clear screen', code: 'basic.clearScreen();', color: 'info' },
        { text: 'pause 0', code: 'basic.pause(0);', color: 'info' }
      ],
      
      loops: [
        { text: 'repeat 0 times', code: 'for (let i = 0; i < 0; i++) {\n  \n}', color: 'loops' },
        { text: 'repeat while', code: 'while (true) {\n  \n}', color: 'loops' },
        { text: 'for index from 0 to 0', code: 'for (let index = 0; index <= 0; index++) {\n  \n}', color: 'loops' },
        { text: 'for each value in list', code: 'for (let value of list) {\n  \n}', color: 'loops' }
      ],
      
      logic: [
        { text: 'if true then', code: 'if (true) {\n  \n}', color: 'logic' },
        { text: 'if true then else', code: 'if (true) {\n  \n} else {\n  \n}', color: 'logic' },
        { text: '= 0', code: '=== 0', color: 'logic' },
        { text: '< 0', code: '< 0', color: 'logic' },
        { text: '> 0', code: '> 0', color: 'logic' },
        { text: 'and', code: '&&', color: 'logic' },
        { text: 'or', code: '||', color: 'logic' },
        { text: 'not', code: '!', color: 'logic' }
      ],
      
      variables: [
        { text: 'set myVariable to 0', code: 'let myVariable = 0;', color: 'variables' },
        { text: 'change myVariable by 0', code: 'myVariable += 0;', color: 'variables' },
        { text: 'show variable myVariable', code: 'basic.showNumber(myVariable);', color: 'variables' },
        { text: 'set myVariable to "hello"', code: 'let myVariable = "hello";', color: 'variables' }
      ],
      
      math: [
        { text: '0 + 0', code: '0 + 0', color: 'math' },
        { text: '0 - 0', code: '0 - 0', color: 'math' },
        { text: '0 √ó 0', code: '0 * 0', color: 'math' },
        { text: '0 √∑ 0', code: '0 / 0', color: 'math' },
        { text: 'pick random 0 to 0', code: 'Math.randomRange(0, 0)', color: 'math' },
        { text: '0 mod 0', code: '0 % 0', color: 'math' },
        { text: '0 ^ 0', code: 'Math.pow(0, 0)', color: 'math' },
        { text: '‚àö 0', code: 'Math.sqrt(0)', color: 'math' },
        { text: 'sin 0', code: 'Math.sin(0)', color: 'math' },
        { text: 'cos 0', code: 'Math.cos(0)', color: 'math' },
        { text: 'tan 0', code: 'Math.tan(0)', color: 'math' },
        { text: 'log 0', code: 'Math.log(0)', color: 'math' },
        { text: 'e ^ 0', code: 'Math.exp(0)', color: 'math' },
        { text: '10 ^ 0', code: 'Math.pow(10, 0)', color: 'math' }
      ],
      
      animation: [
        { text: 'set animation frame to 0', code: 'sprite.setAnimationFrame(0);', color: 'animation' },
        { text: 'change animation frame by 0', code: 'sprite.changeAnimationFrameBy(0);', color: 'animation' },
        { text: 'set animation frame interval to 0', code: 'sprite.setAnimationFrameInterval(0);', color: 'animation' },
        { text: 'start animation', code: 'sprite.startAnimation();', color: 'animation' },
        { text: 'stop animation', code: 'sprite.stopAnimation();', color: 'animation' }
      ],
      
      extensions: [
        { text: 'Advanced Blocks', code: '// Advanced functionality', color: 'extensions' },
        { text: 'Custom Functions', code: 'function customFunction() {\n  \n}', color: 'extensions' },
        { text: 'API Calls', code: 'fetch("https://api.example.com/data")', color: 'extensions' },
        { text: 'Local Storage', code: 'localStorage.setItem("key", "value");', color: 'extensions' }
      ]
    };

    let currentMode = 'blocks';
    let currentCategory = null;
    let workspaceBlocks = [];

    // Switch between block coding and text editor
    function switchMode(mode) {
      currentMode = mode;
      
      // Update button states
      document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Show/hide sections
      if (mode === 'blocks') {
        document.querySelector('.main-container').style.display = 'flex';
        document.querySelector('.text-editor').style.display = 'none';
      } else {
        document.querySelector('.main-container').style.display = 'none';
        document.querySelector('.text-editor').style.display = 'block';
      }
    }

    // Show blocks for a specific category
    function showBlocks(category) {
      currentCategory = category;
      const blocks = blockCategories[category] || [];
      
      // Create block selection area
      const workspace = document.getElementById('block-workspace');
      workspace.innerHTML = '';
      
      // Add category title
      const title = document.createElement('h3');
      title.textContent = category.charAt(0).toUpperCase() + category.slice(1) + ' Blocks';
      title.style.marginBottom = '1rem';
      title.style.color = '#2c3e50';
      workspace.appendChild(title);
      
      // Add blocks
      blocks.forEach(block => {
        const blockElement = document.createElement('div');
        blockElement.className = `block ${block.color}`;
        blockElement.textContent = block.text;
        blockElement.draggable = true;
        blockElement.dataset.code = block.code;
        
        blockElement.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('text/plain', block.code);
          e.dataTransfer.setData('text/html', blockElement.outerHTML);
        });
        
        blockElement.addEventListener('click', () => {
          addBlockToWorkspace(block);
        });
        
        workspace.appendChild(blockElement);
      });
    }

    // Add block to workspace
    function addBlockToWorkspace(block) {
      const workspace = document.querySelector('.workspace-content');
      const blockElement = document.createElement('div');
      blockElement.className = `block ${block.color}`;
      blockElement.textContent = block.text;
      blockElement.style.margin = '0.5rem 0';
      blockElement.onclick = () => blockElement.remove();
      
      workspace.appendChild(blockElement);
      workspaceBlocks.push(block);
      
      updateGeneratedCode();
    }

    // Update generated code from blocks
    function updateGeneratedCode() {
      let code = '// Generated code from blocks\n\n';
      code += '// Initialize\n';
      code += 'let sprite = game.createSprite(2, 2);\n';
      code += 'let score = 0;\n\n';
      
      workspaceBlocks.forEach(block => {
        code += block.code + '\n';
      });
      
      // Update text editor if in text mode
      const codeInput = document.getElementById('code-input');
      if (codeInput) {
        codeInput.value = code;
      }
    }

    // Filter categories
    function filterCategories(searchTerm) {
      const categories = document.querySelectorAll('.category-item');
      categories.forEach(category => {
        const text = category.querySelector('.category-text').textContent.toLowerCase();
        if (text.includes(searchTerm.toLowerCase())) {
          category.style.display = 'flex';
        } else {
          category.style.display = 'none';
        }
      });
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Show default category
      showBlocks('sprite');
      
      // Initialize text editor functionality
      const runBtn = document.getElementById('run-btn');
      const output = document.getElementById('output');
      const codeInput = document.getElementById('code-input');
      const clearBtn = document.getElementById('clear-btn');
      
      if (runBtn) {
        runBtn.addEventListener('click', () => {
          try {
            const code = codeInput.value;
            const originalLog = console.log;
            let outputText = '';
            
            console.log = function(...args) {
              outputText += args.join(' ') + '\n';
              originalLog.apply(console, args);
            };
            
            eval(code);
            console.log = originalLog;
            
            output.textContent = outputText || 'Code executed successfully!';
          } catch (error) {
            output.textContent = 'Error: ' + error.message;
          }
        });
      }
      
      if (clearBtn) {
        clearBtn.addEventListener('click', () => {
          output.textContent = '// Output cleared';
        });
      }
    });
  </script>
</body>
</html> 